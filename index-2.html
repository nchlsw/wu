<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <style>
      table,
      td,
      th {
        border-collapse: collapse;
        border: 1px solid black;
      }
    </style>
    <fieldset>
      <legend>Employee Information</legend>
      <label for="fname">First name:</label>
      <input type="text" id="fname" name="fname" />
      <br />
      <br />
      <label for="lname">Last name:</label>
      <input type="text" id="lname" name="lname" />
      <br />
      <br />
      <label for="email">Email:</label>
      <input type="email" id="email" name="email" />
      <br />
      <br />
      <label for="age">Age:</label>
      <input type="number" id="age" name="age" />
      <br />
      <br />
      <label for="occupation">Occupation</label>
      <select id="occupation">
        <option>Software Developer</option>
        <option>UI/UX</option>
        <option>Digital Marketer</option>
        <option>Data Scientist</option>
      </select>
      <br />
      <br />
      <button onclick="addData()">Create Data</button>
    </fieldset>

    <br />

    <table>
      <fieldset>
        <legend>Search Employee</legend>
        <label for="searchName">Employee Name:</label>
        <input type="text" id="searchName" name="fname" />
        <br />
        <br />
        <label for="searchOccupation">Occupation</label>
        <select id="searchOccupation">
          <option value="">All Occupations</option>
          <option>Software Developer</option>
          <option>UI/UX</option>
          <option>Digital Marketer</option>
          <option>Data Scientist</option>
        </select>
        <br />
        <br />
        <button onclick="searchEmployeeName()">Search Employee</button>
      </fieldset>


      <br>  

      <fieldset>
        <legend>Sort Employee</legend>
        <label for="sortOrder">Order</label>
        <select id="sortOrder">
          <option value="Ascending">Ascending</option>
          <option value="Descending">Descending</option>
        </select>
        <br />
        <br />
        <button onclick="sortName()">Sort Employee By Name</button>
        <button onclick="sortAge()">Sort Employee By Age</button>
        <button onclick="renderData(employeeData)">Reset Sort</button>
      </fieldset>

      <table>
      <caption>
        Employee Database
      </caption>
      <thead>
        <tr>
          <th>No</th>
          <th>Name</th>
          <th>Email</th>
          <th>Age</th>
          <th>Occupation</th>
        </tr>
      </thead>

      <tbody id="tableData">
      </table>
       

  
    <script>
      class Employee {
        constructor(fullName, email, age, occupation) {
          this.fullName = fullName;
          this.email = email;
          this.age = age;
          this.occupation = occupation;
        }
      }

      let employeeData = [
        new Employee("Mark", "mark@mail.com", 23, "Software Developer"),
        new Employee("Steve", "steve@mail.com", 34, "CEO"),
        new Employee("Bill", "bill@mail.com", 45, "UI/UX"),
        new Employee("Seto", "seto@mail.com", 23, "Digital Marketing"),
      ];

      let databaseCopy = [...employeeData]

      const renderData = (newEmployeeData = []) => {
        let htmlResult = "";

        newEmployeeData.forEach((val, idx) => {
          htmlResult += `
          <tr>
            <td>${idx + 1}</td>
            <td>${val.fullName}</td>
            <td>${val.email}</td>
            <td>${val.age}</td>
            <td>${val.occupation}</td>
          </tr>`;
        });
        document.getElementById("tableData").innerHTML = htmlResult;
      };
      renderData(employeeData);

      // const editData = (editIdx) => {
      //   employeeData.forEach((val, idx) => {
      //     let htmlResult = "";
      //     if (idx == editIdx) {
      //       htmlResult += `
      //         <tr>
      //           <td>${idx + 1}</td>
      //           <td><input id="editFullName"${val.fullName}></td>
      //           <td><input id = "editEmail"${val.email}></td>
      //           <td><input id = "editAge"${val.age}></td>
      //           <td><select id="editOccupation">
      //     <option ${
      //       val.occupation == "Software Developer" ? "Selected" : ""
      //     }>Software Developer</option>
      //     <option ${val.occupation == "UI/UX" ? "Selected" : ""}>UI/UX</option>
      //     <option ${
      //       val.occupation == "Digital Marketing" ? "Selected" : ""
      //     }>Digital Marketer</option>
      //     <option ${
      //       val.occupation == "Data Scientist" ? "Selected" : ""
      //     }>Data Scientist</option></td>
      //     <td><button onclick="renderData()">Cancel</button></td>
      //     <td><button onclick="saveEditData(${idx})">Save</button></td>
      //         `;
      //     } else {
      //       htmlResult += `
      //       <tr>
      //         <td>${idx + 1}</td>
      //         <td>${val.fullName}</td>
      //         <td>${val.email}</td>
      //         <td>${val.age}</td>
      //         <td>${val.occupation}</td>
      //         <td><button onclick ="editData(${idx})">Edit</button></td>
      //         <td><button onclick ="deleteData(${idx})">Delete</button></td>
      //       </tr>`;
      //     }
      //   });
      //   document.getElementById("tableData").innerHTML = htmlResult;
      // };

      const addData = () => {
        const fullNameInput = `${document.getElementById("fname").value} ${
          document.getElementById("lname").value
        }`;
        const emailInput = document.getElementById("email").value;
        let ageInput = document.getElementById("age").value;
        ageInput = parseInt(ageInput);
        const occupationInput = document.getElementById("occupation").value;

        const newEmployee = new Employee(
          fullNameInput,
          emailInput,
          ageInput,
          occupationInput
        );
        employeeData.push(newEmployee);
        console.log(employeeData);
        renderData(employeeData);
      };
      // const deleteData = (deleteIdx) => {
      //   employeeData.splice(deleteIdx, 1);
      //   renderData();
      // };

      // const saveEditData = (editIdx) => {
      //   const fullNameInput = document.getElementById("editFullName").value;
      //   const emailInput = document.getElementById("editEmail").value;
      //   const ageInput = document.getElementById("editAge").value;
      //   const occupationInput = document.getElementById("editOccupation").value;

      //   employeeData[editIdx].fullName = fullNameInput;
      //   employeeData[editIdx].email = emailInput;
      //   employeeData[editIdx].age = ageInput;
      //   employeeData[editIdx].occupation = occupationInput;
      //   renderData();
      // };

      const searchEmployeeName = () => {
        const searchEmployeeNameValue =
          document.getElementById("searchName").value;
        const searchEmployeeOccupationValue =
          document.getElementById("searchOccupation").value;

       let searchedData = employeeData.filter((val) => {return (
            val.fullName
              .toLowerCase()
              .includes(searchEmployeeNameValue.toLowerCase()) &&
            val.occupation
              .toLowerCase()
              .includes(searchEmployeeOccupationValue.toLowerCase())
          ) 
       })
        renderData(searchedData);
      } 
      // let databaseCopy = [...employeeData]
      const sortName = () => {
        let databaseCopy = [...employeeData]
        let sortOrderInput= document.getElementById("sortOrder").value
        if (sortOrderInput == "Ascending"){
              databaseCopy.sort((a, b) => {
              if (a.fullName.toLowerCase() < b.fullName.toLowerCase()) {
                return -1;
              } else if (a.fullName.toLowerCase() > b.fullName.toLowerCase()) {
                return 1; 
              }
        }) } else if (sortOrderInput == "Descending") {
              databaseCopy.sort((a, b) => {
              if (a.fullName.toLowerCase() > b.fullName.toLowerCase()) {
                return -1;
              } else if (a.fullName.toLowerCase() < b.fullName.toLowerCase()) {
                return 1 
              }
              } ) 
              }
              renderData(databaseCopy)
            }
      const sortAge = () => {
        let databaseCopy = [...employeeData]
        let sortOrderInput= document.getElementById("sortOrder").value
        if (sortOrderInput == "Ascending"){
           databaseCopy.sort((a, b) => {
              if (a.age < b.age) {
                return -1;
              } else if (a.age > b.age) {
                return 1; 
              }
        }) } else if (sortOrderInput == "Descending") {
            databaseCopy.sort((a, b) => {
              if (a.age > b.age) {
                return -1;
              } else if (a.age < b.age) {
                return 1 
              }
              } ) 
              }
              renderData(databaseCopy)
            }
    </script>
  </body>
</html>
